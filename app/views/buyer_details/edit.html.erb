<% content_for :page_title, t(".heading.#{@section}") %>
<% content_for :breadcrumbs, govuk_breadcrumbs([
  { text: t('buyer_details.index.heading'), href: buyer_details_path(params[:service].dasherize, params[:framework]) },
  { text: t('buyer_details.show.heading'), href: buyer_detail_path(params[:service].dasherize, params[:framework], @buyer_detail) },
  { text: t(".heading.#{@section}") }
]) %>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <%= form_with url: buyer_detail_path(params[:service].dasherize, params[:framework], @buyer_detail, section: @section), model: @buyer_detail, method: :put, html: { novalidate: true } do |f| %>
      <%= render partial: 'shared/error_summary', locals: { errors: @buyer_detail.errors } %>

      <%= govuk_fieldset(
        legend: {
          text: t(".heading.#{@section}"),
          classes: 'govuk-fieldset__legend--l',
          is_page_heading: true,
          caption: {
            text: current_user.email,
            classes: 'govuk-caption-l'
          }
        }
      ) do %>
        <%= render partial: "buyer_details/sections/#{@section}", locals: { form: f } %>
      <% end %>

      <%= govuk_button(t('.save_and_return'), form: f, attributes: { aria: { label: t('.save_and_return') } }) %>
    <% end %>
  </div>
</div>
