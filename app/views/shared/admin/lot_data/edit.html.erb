<%= content_for :page_title, t('.heading.heading', section: t(".heading.#{@section}")) %>

<% admin_breadcrumbs(
  { text: t('shared.admin.suppliers.index.heading'), href: suppliers_index_path },
  { text: t('shared.admin.lot_data.index.heading'), href: supplier_lot_data_index_path(@supplier_framework) },
  *if @section == :lot_status
    []
  else
    [
      { text: t('shared.admin.lot_data.show.heading.heading', section: t("shared.admin.lot_data.show.heading.#{@section}")), href: supplier_lot_data_show_path(@supplier_framework, @lot.number_as_slug, @section) },
    ]
  end + [
    { text: t('.heading.heading', section: t(".heading.#{@section}")) }
  ]
)%>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-three-quarters">
    <%= form_with url: supplier_lot_data_update_path(@supplier_framework, @lot.number_as_slug, @section), model: @model, method: :put, html: { novalidate: true } do |f| %>
      <%= render partial: 'shared/error_summary', locals: { errors: @model.errors } %>

      <%= govuk_fieldset(
        legend: {
          text: t('.heading.heading', section: t(".heading.#{@section}")),
          classes: 'govuk-fieldset__legend--l',
          is_page_heading: true,
          caption: {
            text: capture do
              concat(tag.span(@supplier_framework.supplier_name, class: 'govuk-caption-m'))
              concat(tag.span(t(".heading.caption", lot_number: @lot.number, lot_name: @lot.name), class: 'govuk-caption-l'))
            end,
          }
        }
      ) do %>
        <%= render(partial: "#{service.to_s.underscore}/admin/lot_data/edit/#{@section}", locals: { form: f }) %>
      <% end %>

      <%= govuk_button(t('.save_and_return'), form: f, attributes: { aria: { label: t('.save_and_return') } }) %>
    <% end %>
  </div>
</div>


